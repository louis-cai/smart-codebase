# Smart-Codebase

[English](README.md) | [ç®€ä½“ä¸­æ–‡](README.zh-cn.md)

> **è®©ä½ çš„ OpenCode åœ¨å®Œæˆä»»åŠ¡æ—¶ï¼Œä¸æ–­å­¦ä¹ æˆé•¿ï¼Œå˜æˆä½ ç‹¬ä¸€æ— äºŒçš„èµ„æ·±é¡¹ç›®ä¸“å®¶ã€‚**

---

## ğŸ”¥ ä½ çš„ç—›ç‚¹

æ¯æ¬¡å¼€å§‹æ–°ä¼šè¯æ—¶ï¼ŒAI éƒ½ä»é›¶å¼€å§‹ã€‚å®ƒä¸è®°å¾—ï¼š
- ä½ ä¸ºä»€ä¹ˆé€‰æ‹©é‚£ä¸ªæ¶æ„ï¼Ÿ
- ä»£ç åº“ä¸­å­˜åœ¨å“ªäº›å‘ï¼Ÿ
- ä½ çš„å›¢é˜Ÿéµå¾ªä»€ä¹ˆæ¨¡å¼ï¼Ÿ
- ä½ ä»è°ƒè¯•é‚£ä¸ªæ£˜æ‰‹çš„ bug ä¸­å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ

**ä½ ä¸€éåˆä¸€éåœ°è§£é‡ŠåŒæ ·çš„äº‹æƒ…ã€‚**

## âœ¨ è§£å†³æ–¹æ¡ˆ

smart-codebase è‡ªåŠ¨ä»ä¼šè¯ä¸­æ•è·çŸ¥è¯†ï¼Œå¹¶ä½¿å…¶å¯ä¾›æœªæ¥ä¼šè¯ä½¿ç”¨ã€‚

```mermaid
graph TB
    Start([ä¼šè¯å·¥ä½œ])
    Extractor[AI æå–å™¨åˆ†æ]
    SkillFile[.knowledge/SKILL.md<br/>æ¨¡å—çŸ¥è¯†]
    ProjectSkill[.opencode/skills/project/SKILL.md<br/>OpenCode è‡ªåŠ¨å‘ç°]
    NewSession([æ–°ä¼šè¯å¼€å§‹])
    Injector[çŸ¥è¯†æ³¨å…¥å™¨]
    
    Start -->|ç©ºé—²| Extractor
    Extractor -->|å†™å…¥| SkillFile
    Extractor -->|æ›´æ–°ç´¢å¼•| ProjectSkill
    
    NewSession --> Injector
    Injector -->|æ³¨å…¥æç¤º| ProjectSkill
    ProjectSkill -.->|å¼•ç”¨| SkillFile
```

---

## ğŸ“– ç›®å½•

- [âš™ï¸ å·¥ä½œåŸç†](#ï¸-å·¥ä½œåŸç†)
- [ğŸ“¦ å®‰è£…](#-å®‰è£…)
- [ğŸ”§ å‘½ä»¤](#-å‘½ä»¤)
- [âš¡ é…ç½®](#-é…ç½®)
- [ğŸ“ æ–‡ä»¶ç»“æ„](#-æ–‡ä»¶ç»“æ„)
- [ğŸ› ï¸ å¼€å‘](#ï¸-å¼€å‘)

---

## âš™ï¸ å·¥ä½œåŸç†

1. **ä½ æ­£å¸¸å·¥ä½œ** - ç¼–è¾‘æ–‡ä»¶ã€è°ƒè¯•é—®é¢˜ã€åšå†³ç­–
2. **ä¼šè¯ç©ºé—²** - 15 ç§’æ— æ´»åŠ¨å
3. **æå–å™¨åˆ†æ** - æ£€æŸ¥å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ä»¥åŠä¸ºä»€ä¹ˆ
4. **çŸ¥è¯†è¢«æ•è·** - å­˜å‚¨åœ¨ `<æ¨¡å—>/.knowledge/SKILL.md` ä¸­
5. **ç´¢å¼•æ›´æ–°** - å…¨å±€ç´¢å¼•ä½äº `.opencode/skills/<é¡¹ç›®>/SKILL.md`
6. **ä¸‹æ¬¡ä¼šè¯å¼€å§‹** - AI å…ˆè¯»å–é¡¹ç›® skillï¼Œå†è¯»å–ç›¸å…³æ¨¡å— skill

**æ’ä»¶å¸®ä½ æ²‰æ·€çŸ¥è¯†ï¼Œä½ åªç®¡é­ç­– AI å†™ä»£ç ã€‚**

---

## ğŸ“¦ å®‰è£…

è¿›å…¥ `~/.config/opencode` ç›®å½•ï¼š

```bash
# ä½¿ç”¨ bun
bun add smart-codebase

# æˆ–ä½¿ç”¨ npm
npm install smart-codebase
```

æ·»åŠ åˆ°ä½ çš„ `opencode.json`ï¼š

```json
{
  "plugin": ["smart-codebase"]
}
```

---

## âš¡ å‘½ä»¤

| å‘½ä»¤ | æè¿° |
|------|------|
| `/sc-status` | æ˜¾ç¤ºçŸ¥è¯†åº“çŠ¶æ€ |
| `/sc-extract` | æ‰‹åŠ¨è§¦å‘çŸ¥è¯†æ²‰æ·€ |
| `/sc-rebuild-index` | ä»æ‰€æœ‰ SKILL.md æ–‡ä»¶é‡å»º `.knowledge/KNOWLEDGE.md` |

---

## âš™ï¸ é…ç½®

é»˜è®¤æ— é¡»é…ç½®ï¼Œå¦‚éœ€æ”¹å˜é»˜è®¤é…ç½®ï¼Œåˆ›å»º `~/.config/opencode/smart-codebase.json`ï¼ˆæˆ– `.jsonc`ï¼‰ï¼š

```jsonc
{
  "enabled": true,
  "debounceMs": 30000,
  "autoExtract": true,
  "autoInject": true,
  "extractionModel": "minimax/MiniMax-M2.1",
  "disabledCommands": ["sc-rebuild-index"]
}
```

| é€‰é¡¹ | é»˜è®¤å€¼ | æè¿° |
|------|--------|------|
| `enabled` | `true` | å®Œå…¨å¯ç”¨/ç¦ç”¨æ’ä»¶ |
| `debounceMs` | `15000` | ä¼šè¯ç©ºé—²åç­‰å¾…å¤šä¹…ï¼ˆæ¯«ç§’ï¼‰æ‰æå– |
| `autoExtract` | `true` | ç©ºé—²æ—¶è‡ªåŠ¨æå–çŸ¥è¯† |
| `autoInject` | `true` | ä¼šè¯å¼€å§‹æ—¶æ³¨å…¥çŸ¥è¯†æç¤º |
| `extractionModel` | - | çŸ¥è¯†æå–ä½¿ç”¨çš„æ¨¡å‹ï¼Œæ ¼å¼ï¼š`providerID/modelID` |
| `extractionMaxTokens` | `8000` | æå–ä¸Šä¸‹æ–‡çš„æœ€å¤§ token é¢„ç®— |
| `disabledCommands` | `[]` | è¦ç¦ç”¨çš„å‘½ä»¤ï¼Œå¦‚ `["sc-rebuild-index"]` |

---

## ğŸ“ æ–‡ä»¶ç»“æ„ç¤ºä¾‹

```
project/
â”œâ”€â”€ .opencode/
â”‚   â””â”€â”€ skills/
â”‚       â””â”€â”€ <é¡¹ç›®å>/
â”‚           â””â”€â”€ SKILL.md          # é¡¹ç›® skill
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ .knowledge/
â”‚   â”‚   â”‚   â””â”€â”€ SKILL.md          # è®¤è¯æ¨¡å—çŸ¥è¯†
â”‚   â”‚   â”œâ”€â”€ session.ts
â”‚   â”‚   â””â”€â”€ jwt.ts
â”‚   â”‚
â”‚   â””â”€â”€ payments/
â”‚       â”œâ”€â”€ .knowledge/
â”‚       â”‚   â””â”€â”€ SKILL.md          # æ”¯ä»˜æ¨¡å—çŸ¥è¯†
â”‚       â””â”€â”€ stripe.ts
```

`.opencode/skills/<é¡¹ç›®>/SKILL.md` ä½œä¸ºå…¨å±€ç´¢å¼•ï¼Œä¼šè¢« OpenCode è‡ªåŠ¨å‘ç°ã€‚æ¨¡å—çº§åˆ«çš„çŸ¥è¯†å­˜å‚¨åœ¨å„æ¨¡å—ç›®å½•çš„ `.knowledge/SKILL.md` ä¸­ã€‚

---

## ğŸ› ï¸ å¼€å‘

```bash
# å®‰è£…ä¾èµ–
bun install

# æ„å»º
bun run build

# ç±»å‹æ£€æŸ¥
bun run typecheck
```

---

## ğŸ“„ è®¸å¯è¯

[Apache-2.0](LICENSE)
